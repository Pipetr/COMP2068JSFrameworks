{{#section 'styles'}}
<link rel="stylesheet" href="/stylesheets/work.css">
{{/section}}

<div class="container">
  {{#if isAuthenticated}}
    <a href="/work/dashboard" class="back-link">
      <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
    </a>
  {{else}}
    <a href="/" class="back-link">
      <i class="fas fa-arrow-left me-2"></i>Back to Home
    </a>
  {{/if}}

  <div class="public-header">
    <div class="container">
      <h1><i class="fas fa-chart-line me-2"></i>Platform Statistics</h1>
      <p class="mb-0">See how Work Tracker is helping professionals manage their time</p>
    </div>
  </div>

  {{#if error}}
    <div class="alert alert-danger" role="alert">
      {{error}}
    </div>
  {{/if}}

  <div class="row">
    <!-- Statistics Cards -->
    <div class="col-md-6 col-lg-3 mb-4">
      <div class="entry-card text-center">
        <div class="entry-body">
          <i class="fas fa-users fa-3x text-primary mb-3"></i>
          <h3 class="text-primary">{{stats.totalUsers}}</h3>
          <p class="mb-0">Registered Users</p>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="entry-card text-center">
        <div class="entry-body">
          <i class="fas fa-project-diagram fa-3x text-success mb-3"></i>
          <h3 class="text-success">{{stats.totalProjects}}</h3>
          <p class="mb-0">Total Projects</p>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="entry-card text-center">
        <div class="entry-body">
          <i class="fas fa-clock fa-3x text-warning mb-3"></i>
          <h3 class="text-warning">{{stats.totalHoursWorked}}</h3>
          <p class="mb-0">Hours Tracked</p>
        </div>
      </div>
    </div>

    <div class="col-md-6 col-lg-3 mb-4">
      <div class="entry-card text-center">
        <div class="entry-body">
          <i class="fas fa-tasks fa-3x text-info mb-3"></i>
          <h3 class="text-info">{{stats.totalWorkEntries}}</h3>
          <p class="mb-0">Work Entries</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Statistics -->
  <div class="row">
    <div class="col-md-6 mb-4">
      <div class="entry-card">
        <div class="entry-header">
          <div class="entry-project">
            <i class="fas fa-chart-bar me-2"></i>Active Projects
          </div>
        </div>
        <div class="entry-body">
          <div class="d-flex justify-content-between align-items-center">
            <span class="h4 mb-0">{{stats.activeProjects}}</span>
            <small class="text-muted">Currently in progress</small>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="entry-card">
        <div class="entry-header">
          <div class="entry-project">
            <i class="fas fa-dollar-sign me-2"></i>Average Hourly Rate
          </div>
        </div>
        <div class="entry-body">
          <div class="d-flex justify-content-between align-items-center">
            <span class="h4 mb-0">${{stats.avgHourlyRate}}</span>
            <small class="text-muted">Platform average</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  {{#if stats.recentActivity.length}}
    <div class="row">
      <div class="col-12">
        <div class="entry-card">
          <div class="entry-header">
            <div class="entry-project">
              <i class="fas fa-activity me-2"></i>Recent Activity (Last 7 Days)
            </div>
          </div>
          <div class="entry-body">
            <div class="table-responsive">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Entries</th>
                    <th>Hours</th>
                  </tr>
                </thead>
                <tbody>
                  {{#each stats.recentActivity}}
                    <tr>
                      <td>{{this._id}}</td>
                      <td>{{this.entriesCount}}</td>
                      <td>{{#if this.totalHours}}{{this.totalHours}}{{else}}0.00{{/if}}</td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  {{/if}}

  {{#unless isAuthenticated}}
    <div class="text-center mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Join the Work Tracker Community</h5>
          <p class="card-text">Become part of a growing community of professionals who track their time and maximize their productivity.</p>
          <a href="/auth/register" class="btn btn-primary me-2">
            <i class="fas fa-user-plus me-2"></i>Get Started Free
          </a>
          <a href="/auth/login" class="btn btn-outline-primary">
            <i class="fas fa-sign-in-alt me-2"></i>Sign In
          </a>
        </div>
      </div>
    </div>
  {{else}}
    <div class="text-center mt-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Ready to track your work?</h5>
          <p class="card-text">Start logging your hours and managing your projects.</p>
          <a href="/work/dashboard" class="btn btn-primary me-2">
            <i class="fas fa-tachometer-alt me-2"></i>Go to Dashboard
          </a>
          <a href="/work/add" class="btn btn-outline-primary">
            <i class="fas fa-plus me-2"></i>Add Work Entry
          </a>
        </div>
      </div>
    </div>
  {{/unless}}
</div>
